<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PixelArena Bonus</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;}
body{background:linear-gradient(180deg,#0b1023,#0d1333,#0a0f1f);color:white;overflow-x:hidden;}

/* ================= TOP BAR (INDEX ƒ∞LE AYNI) ================= */
.top-bar{
position:fixed;
top:0;
width:100%;
height:55px;
display:flex;
align-items:center;
justify-content:space-between;
padding:0 16px;
background:linear-gradient(135deg,#1a2a6c,#16245c);
box-shadow:0 4px 15px rgba(0,0,0,0.45);
z-index:1000;
}
.brand{
font-size:18px;
font-weight:800;
background:linear-gradient(90deg,#4fd1ff,#fff,#4fd1ff);
background-size:200% auto;
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
animation:shine 3s linear infinite;
}
@keyframes shine{to{background-position:200% center;}}

.right-menu{display:flex;gap:10px;align-items:center;}
.nav-box{padding:6px 14px;border-radius:14px;font-weight:700;font-size:13px;min-width:95px;text-align:center;}
.balance-box{background:#273c8f;display:none;}
.btn{padding:6px 12px;border-radius:12px;border:none;cursor:pointer;font-weight:700;font-size:13px;}
.logout-btn{background:#ff3b3b;color:white;}

/* SIDE MENU */
.side-menu{
position:fixed;
top:0;
left:-260px;
width:260px;
height:100%;
background:linear-gradient(180deg,#12183c,#0d1333);
padding:20px;
transition:0.4s;
z-index:3000;
box-shadow:5px 0 25px rgba(0,0,0,0.5);
}
.side-menu.active{left:0;}
.side-menu a{
display:block;
padding:14px 10px;
margin:8px 0;
border-radius:10px;
text-decoration:none;
color:white;
font-weight:600;
background:#1e2a5a;
}
.menu-overlay{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.6);
display:none;
z-index:2500;
}
.menu-overlay.active{display:block;}

/* ================= PANEL CONTENT ================= */
.panel-container{
margin-top:90px;
padding:20px;
padding-bottom:100px;
}

.card{
background:linear-gradient(145deg,#141b3f,#1b2252);
border-radius:18px;
padding:25px;
text-align:center;
cursor:pointer;
transition:0.4s;
border:1px solid #2a3577;
box-shadow:0 0 15px #ffb30030;
margin-bottom:20px;
}
.card:hover{
transform:translateY(-5px);
box-shadow:0 0 30px #ffb300;
}

/* WHEEL */
.wheel-container{
position:relative;
width:260px;
height:260px;
margin:20px auto;
}
#wheel{
width:100%;
height:100%;
border-radius:50%;
border:8px solid #00f5ff;
box-shadow:0 0 20px #00f5ff,0 0 40px #00f5ff;
transition:transform 4s cubic-bezier(0.17,0.67,0.83,0.67);
}
.pointer{
position:absolute;
top:-15px;
left:50%;
transform:translateX(-50%);
border-left:15px solid transparent;
border-right:15px solid transparent;
border-bottom:30px solid #ffb300;
}

/* MODAL */
.modal{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,0.7);
display:none;
justify-content:center;
align-items:center;
z-index:5000;
}
.modal-content{
background:linear-gradient(145deg,#1c2455,#12183c);
padding:30px;
border-radius:20px;
width:90%;
max-width:400px;
position:relative;
}
.close{
position:absolute;
right:15px;
top:10px;
cursor:pointer;
font-size:18px;
}
input{
width:100%;
padding:12px;
margin-bottom:10px;
border-radius:12px;
border:none;
background:#1f285c;
color:white;
}
.action-btn{
width:100%;
padding:12px;
border:none;
border-radius:12px;
background:linear-gradient(90deg,#ffb300,#ff8c00);
font-weight:bold;
cursor:pointer;
}
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="top-bar">
  <div style="display:flex;align-items:center;gap:12px;">
    <div id="menuBtn" style="font-size:22px;cursor:pointer;">‚ò∞</div>
    <div class="brand">PixelArena Bonus</div>
  </div>

  <div class="right-menu">
    <div class="nav-box balance-box" id="balanceBox">
      Bakiye: <span id="balance">0‚Ç∫</span>
    </div>
    <button class="btn logout-btn" id="logoutBtn">√áƒ±kƒ±≈ü</button>
  </div>
</div>

<!-- SIDE MENU -->
<div id="sideMenu" class="side-menu">
  <h3>Men√º</h3>
  <a href="index.html">üè† Ana Sayfa</a>
  <a href="panel.html">üíé Bonus Kod / √áark</a>
</div>
<div id="menuOverlay" class="menu-overlay"></div>

<!-- PANEL CONTENT -->
<div class="panel-container">

<div class="card" onclick="openModal('codeModal')">
üéÅ Bonus Kod Gir
</div>

<div class="card" onclick="openModal('wheelModal')">
üé° G√ºnl√ºk √áark √áevir
</div>

</div>

<!-- CODE MODAL -->
<div class="modal" id="codeModal">
<div class="modal-content">
<div class="close" onclick="closeModal('codeModal')">‚úñ</div>
<h3>Kod Gir</h3>
<input id="codeInput" placeholder="Kodu yaz">
<button class="action-btn" onclick="useCode()">Kullan</button>
</div>
</div>

<!-- WHEEL MODAL -->
<div class="modal" id="wheelModal">
<div class="modal-content">
<div class="close" onclick="closeModal('wheelModal')">‚úñ</div>
<h3>G√ºnl√ºk √áark</h3>

<div class="wheel-container">
<div class="pointer"></div>
<canvas id="wheel" width="260" height="260"></canvas>
</div>

<button class="action-btn" onclick="spinWheel()">√áevir</button>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, getDoc, updateDoc, increment } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"AIzaSyBykwXCOJpX6rG0pUx93HmALjVcCQWVMYA",
  authDomain:"emirhan-site.firebaseapp.com",
  projectId:"emirhan-site",
  storageBucket:"emirhan-site.firebasestorage.app",
  messagingSenderId:"668871888390",
  appId:"1:668871888390:web:76568bda84cb1641f7bd87"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser=null;

/* AUTH CHECK */
onAuthStateChanged(auth,async(user)=>{
if(!user) return window.location="index.html";
currentUser=user;

document.getElementById("balanceBox").style.display="block";

const snap=await getDoc(doc(db,"users",user.uid));
document.getElementById("balance").innerText=snap.data().balance+"‚Ç∫";
});

/* LOGOUT */
document.getElementById("logoutBtn").onclick=async()=>{
await signOut(auth);
window.location="index.html";
};

/* MENU */
menuBtn.onclick=()=>{
sideMenu.classList.add("active");
menuOverlay.classList.add("active");
};
menuOverlay.onclick=()=>{
sideMenu.classList.remove("active");
menuOverlay.classList.remove("active");
};

/* MODAL */
window.openModal=id=>document.getElementById(id).style.display="flex";
window.closeModal=id=>document.getElementById(id).style.display="none";

/* WHEEL */
const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");
const rewards=[50,100,500,1000];
const angle=2*Math.PI/rewards.length;

for(let i=0;i<rewards.length;i++){
ctx.beginPath();
ctx.moveTo(130,130);
ctx.arc(130,130,130,i*angle,(i+1)*angle);
ctx.fillStyle=i%2?"#00f5ff":"#9333ea";
ctx.fill();
ctx.save();
ctx.translate(130,130);
ctx.rotate(i*angle+angle/2);
ctx.fillStyle="white";
ctx.fillText(rewards[i]+"‚Ç∫",70,5);
ctx.restore();
}

let rotation=0;

window.spinWheel=async()=>{
const index=Math.floor(Math.random()*rewards.length);
const prize=rewards[index];

rotation+=360*5+(360/rewards.length)*index;
canvas.style.transform=`rotate(${rotation}deg)`;

setTimeout(async()=>{
await updateDoc(doc(db,"users",currentUser.uid),{
balance:increment(prize)
});
alert(prize+"‚Ç∫ kazandƒ±n!");
closeModal("wheelModal");
},4000);
};

/* CODE */
window.useCode=async()=>{
const code=document.getElementById("codeInput").value.trim().toUpperCase();
if(!code) return alert("Kod gir.");

const ref=doc(db,"codes",code);
const snap=await getDoc(ref);
if(!snap.exists()) return alert("Kod yok.");

const data=snap.data();

await updateDoc(doc(db,"users",currentUser.uid),{
balance:increment(data.reward)
});

alert(data.reward+"‚Ç∫ kazandƒ±n!");
closeModal("codeModal");
};
</script>

</body>
</html>
