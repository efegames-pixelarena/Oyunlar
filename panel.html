<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PixelArena Bonus</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;}

body{
background:linear-gradient(-45deg,#0b1023,#1a2a6c,#0d1333,#0a0f1f);
background-size:400% 400%;
animation:bgMove 15s ease infinite;
color:white;
overflow-x:hidden;
position:relative;
}
@keyframes bgMove{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}

/* KAR */
.snowflake{
position:fixed;
top:-10px;
color:white;
font-size:10px;
opacity:0.8;
pointer-events:none;
animation:fall linear infinite;
}
@keyframes fall{to{transform:translateY(110vh);}}

/* TOP BAR */
.top-bar{
position:fixed;
top:0;width:100%;height:55px;
display:flex;align-items:center;justify-content:center;
background:linear-gradient(135deg,#1a2a6c,#16245c);
box-shadow:0 0 25px #00f5ff55;
z-index:1000;
}
.brand{
font-size:18px;font-weight:800;
background:linear-gradient(90deg,#4fd1ff,#fff,#4fd1ff);
background-size:200% auto;
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
animation:shine 3s linear infinite;
}
@keyframes shine{to{background-position:200% center;}}

/* BAKƒ∞YE TAMAMEN Gƒ∞ZLƒ∞ */
.balance-box{display:none !important;}

/* PANEL */
.panel-container{margin-top:90px;padding:20px;padding-bottom:120px;}

.animated-btn{
position:relative;
padding:25px;
text-align:center;
border-radius:20px;
cursor:pointer;
font-size:18px;
font-weight:bold;
margin-bottom:25px;
background:#111936;
overflow:hidden;
z-index:1;
}
.animated-btn::before{
content:"";
position:absolute;
top:-50%;left:-50%;
width:200%;height:200%;
background:conic-gradient(#ffb300,#00f5ff,#ff00ff,#ffb300);
animation:rotate 4s linear infinite;
z-index:-2;
}
.animated-btn::after{
content:"";
position:absolute;
inset:4px;
background:#141b3f;
border-radius:16px;
z-index:-1;
}
@keyframes rotate{100%{transform:rotate(360deg);}}

/* FOOTER */
.footer{
position:fixed;
bottom:0;width:100%;
background:#0d1333;
text-align:center;
padding:12px;
font-size:13px;
border-top:1px solid #1e2a5a;
}

/* MODAL */
.modal{
position:fixed;top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,0.8);
display:none;justify-content:center;align-items:center;
z-index:5000;
}
.modal-content{
background:linear-gradient(145deg,#1c2455,#12183c);
padding:30px;border-radius:20px;width:90%;max-width:400px;
position:relative;
box-shadow:0 0 40px #00f5ff55;
}
.close{position:absolute;right:15px;top:10px;cursor:pointer;}

input{
width:100%;padding:12px;margin-bottom:10px;
border-radius:12px;border:none;background:#1f285c;color:white;
}
.action-btn{
width:100%;padding:12px;border:none;border-radius:12px;
background:linear-gradient(90deg,#ffb300,#ff8c00);
font-weight:bold;cursor:pointer;
margin-top:10px;
}

/* PREMIUM NEON WHEEL */
.wheel-container{position:relative;width:300px;height:300px;margin:20px auto;}

#wheel{
width:100%;height:100%;
border-radius:50%;
border:10px solid #00f5ff;
box-shadow:
0 0 25px #00f5ff,
0 0 50px #00f5ff,
0 0 80px #9333ea;
transition:transform 4.5s cubic-bezier(0.17,0.67,0.83,0.67);
background:#111;
}

.pointer{
position:absolute;top:-20px;left:50%;transform:translateX(-50%);
border-left:18px solid transparent;
border-right:18px solid transparent;
border-bottom:35px solid #ffb300;
filter:drop-shadow(0 0 15px #ffb300);
}
</style>
</head>
<body>

<div class="top-bar">
<div class="brand">PixelArena Bonus</div>
<div class="balance-box" id="balanceBox">
Bakiye: <span id="balance">0‚Ç∫</span>
</div>
</div>

<div class="panel-container">
<div class="animated-btn" onclick="openModal('codeModal')">üéÅ BONUS KOD Gƒ∞R</div>
<div class="animated-btn" onclick="openModal('wheelModal')">üé° G√úNL√úK √áARK √áEVƒ∞R</div>
<div class="animated-btn" onclick="window.location.href='index.html'">üè† ANA SAYFAYA D√ñN</div>
</div>

<div class="footer">¬© 2026 PixelArena - T√ºm Haklarƒ± Saklƒ±dƒ±r</div>

<!-- MODALS -->
<div class="modal" id="codeModal">
<div class="modal-content">
<div class="close" onclick="closeModal('codeModal')">‚úñ</div>
<h3>Kod Gir</h3>
<input id="codeInput" placeholder="Kodu yaz">
<button class="action-btn" onclick="useCode()">Kullan</button>
</div>
</div>

<div class="modal" id="wheelModal">
<div class="modal-content">
<div class="close" onclick="closeModal('wheelModal')">‚úñ</div>
<h3>G√ºnl√ºk √áark</h3>
<div class="wheel-container">
<div class="pointer"></div>
<canvas id="wheel" width="300" height="300"></canvas>
</div>
<button class="action-btn" onclick="spinWheel()">√áevir</button>
</div>
</div>

<!-- iOS UYUMLU SES -->
<audio id="spinSound" preload="auto" playsinline>
<source src="https://assets.mixkit.co/sfx/preview/mixkit-slot-machine-wheel-1934.mp3" type="audio/mpeg">
</audio>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, getDoc, updateDoc, increment, setDoc } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig={
apiKey:"AIzaSyBykwXCOJpX6rG0pUx93HmALjVcCQWVMYA",
authDomain:"emirhan-site.firebaseapp.com",
projectId:"emirhan-site",
storageBucket:"emirhan-site.firebasestorage.app",
messagingSenderId:"668871888390",
appId:"1:668871888390:web:76568bda84cb1641f7bd87"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

let currentUser=null;

onAuthStateChanged(auth,(user)=>{
if(!user){window.location="index.html";return;}
currentUser=user;
});

/* =========================
   iOS %100 SES √á√ñZ√úM√ú
========================= */
const spinSound=document.getElementById("spinSound");

function unlockIOSAudio(){
spinSound.play().then(()=>{
spinSound.pause();
spinSound.currentTime=0;
}).catch(()=>{});
}

document.addEventListener("touchstart",unlockIOSAudio,{once:true});
document.addEventListener("click",unlockIOSAudio,{once:true});

/* =========================
   MODAL
========================= */
window.openModal=id=>document.getElementById(id).style.display="flex";
window.closeModal=id=>document.getElementById(id).style.display="none";

/* =========================
   √áARK √áƒ∞Zƒ∞Mƒ∞
========================= */
const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");

const rewards=[50,100,500,1000];
const angle=2*Math.PI/rewards.length;

for(let i=0;i<rewards.length;i++){
ctx.beginPath();
ctx.moveTo(150,150);
ctx.arc(150,150,150,i*angle,(i+1)*angle);
ctx.fillStyle=i%2?"#00f5ff":"#9333ea";
ctx.fill();

ctx.save();
ctx.translate(150,150);
ctx.rotate(i*angle+angle/2);
ctx.fillStyle="white";
ctx.strokeStyle="black";
ctx.lineWidth=4;
ctx.font="bold 24px Arial";
ctx.textAlign="center";
ctx.strokeText(rewards[i]+"‚Ç∫",100,10);
ctx.fillText(rewards[i]+"‚Ç∫",100,10);
ctx.restore();
}

let rotation=0;

/* =========================
   G√úNL√úK 1 √áARK HAKKI
========================= */
window.spinWheel=async()=>{

const userRef=doc(db,"users",currentUser.uid);
const snap=await getDoc(userRef);

const today=new Date();
const todayKey=today.getFullYear()+"-"+(today.getMonth()+1)+"-"+today.getDate();

if(snap.exists() && snap.data().lastSpinDate===todayKey){
alert("Bug√ºn √ßark hakkƒ±nƒ± kullandƒ±n!");
return;
}

/* Ses ba≈ülat */
spinSound.currentTime=0;
await spinSound.play().catch(()=>{});

/* Rastgele √∂d√ºl */
const index=Math.floor(Math.random()*rewards.length);
const prize=rewards[index];

rotation+=360*6+(360/rewards.length)*index;
canvas.style.transform=`rotate(${rotation}deg)`;

/* √ñd√ºl verme */
setTimeout(async()=>{
await setDoc(userRef,{
balance: increment(prize),
lastSpinDate: todayKey
},{merge:true});

alert(prize+"‚Ç∫ kazandƒ±n!");
closeModal("wheelModal");
},4500);

};

/* =========================
   KOD Sƒ∞STEMƒ∞ (DEƒûƒ∞≈ûMEDƒ∞)
========================= */
window.useCode=async()=>{
const code=document.getElementById("codeInput").value.trim().toUpperCase();
if(!code) return alert("Kod gir.");

const ref=doc(db,"codes",code);
const snap=await getDoc(ref);

if(!snap.exists()) return alert("Kod yok.");

await updateDoc(doc(db,"users",currentUser.uid),{
balance:increment(snap.data().reward)
});

alert(snap.data().reward+"‚Ç∫ kazandƒ±n!");
closeModal("codeModal");
};
</script>
