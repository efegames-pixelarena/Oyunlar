<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SkyCrash</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:#0b0f14;color:white}

.header{
height:60px;
background:#111418;
display:flex;
justify-content:space-between;
align-items:center;
padding:0 15px;
}
.headerLeft{
font-size:26px;
font-weight:bold;
color:#ff3b4d;
font-style:italic;
}
.balanceTop{color:#4caf50;font-weight:bold;font-size:18px;}

.historyBar{
height:45px;
display:flex;
align-items:center;
padding:0 10px;
border-top:1px solid #1f2633;
border-bottom:1px solid #1f2633;
overflow:hidden;
}
.historyList{
display:flex;
gap:15px;
overflow-x:auto;
}
.historyItem{font-weight:bold;font-size:18px;white-space:nowrap;}

.crashContainer{
position:relative;
height:300px;
margin:15px;
border-radius:20px;
overflow:hidden;
background:radial-gradient(circle at center,#3a0066 0%,#0a0a0f 70%);
}
.multiplier{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
font-size:65px;
font-weight:bold;
}

.betSection{
display:flex;
gap:15px;
padding:15px;
}
.betCard{
flex:1;
background:linear-gradient(145deg,#181c24,#0e1015);
padding:15px;
border-radius:20px;
}
.betControl{
display:flex;
justify-content:space-between;
align-items:center;
background:#11151c;
padding:10px;
border-radius:15px;
margin-bottom:10px;
}
.betControl button{
background:#1b1f27;
border:none;
color:white;
font-size:18px;
width:40px;height:40px;
border-radius:50%;
}
.betAmount{font-size:22px;font-weight:bold;}

.quickAmounts{
display:grid;
grid-template-columns:repeat(4,1fr);
gap:8px;margin-bottom:12px;
}
.quickAmounts button{
background:#151922;
border:none;padding:8px;
border-radius:10px;color:#aaa;
}

.betButton{
width:100%;
background:#22b300;
color:white;
border:none;
padding:15px;
font-size:20px;
border-radius:15px;
}
.betButton.cashout{
background:#00eaff;
color:black;
}
</style>
</head>
<body>

<div class="header">
<div class="headerLeft">Aviator</div>
<div class="balanceTop"><span id="balanceTop">0</span> TRY</div>
</div>

<div class="historyBar">
<div class="historyList" id="historyList"></div>
</div>

<div class="crashContainer">
<div class="multiplier" id="multiplierDisplay">1.00x</div>
</div>

<div class="betSection">

<div class="betCard">
<div class="betControl">
<button id="minus1">−</button>
<div class="betAmount" id="betDisplay1">1.00</div>
<button id="plus1">+</button>
</div>
<div class="quickAmounts">
<button class="quick1" data-bet="1">1</button>
<button class="quick1" data-bet="2">2</button>
<button class="quick1" data-bet="5">5</button>
<button class="quick1" data-bet="10">10</button>
</div>
<button class="betButton" id="betBtn1">Bahis</button>
</div>

<div class="betCard">
<div class="betControl">
<button id="minus2">−</button>
<div class="betAmount" id="betDisplay2">1.00</div>
<button id="plus2">+</button>
</div>
<div class="quickAmounts">
<button class="quick2" data-bet="1">1</button>
<button class="quick2" data-bet="2">2</button>
<button class="quick2" data-bet="5">5</button>
<button class="quick2" data-bet="10">10</button>
</div>
<button class="betButton" id="betBtn2">Bahis</button>
</div>

</div>

<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
apiKey:"AIzaSyBykwXCOJpX6rG0pUx93HmALjVcCQWVMYA",
authDomain:"emirhan-site.firebaseapp.com",
projectId:"emirhan-site",
storageBucket:"emirhan-site.firebasestorage.app",
messagingSenderId:"668871888390",
appId:"1:668871888390:web:76568bda84cb1641f7bd87"
};

firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

let balance=0;
let userRef=null;

auth.onAuthStateChanged(user=>{
if(!user) return;
userRef=db.collection("users").doc(user.uid);
userRef.onSnapshot(doc=>{
if(doc.exists){
balance=doc.data().balance||0;
document.getElementById("balanceTop").innerText=Math.round(balance);
}
});
});

function updateBalance(val){
if(!userRef) return;
userRef.update({balance:Math.round(val)});
}

/* GAME */
let multiplier=1;
let crashPoint=0;
let phase="betting";
let animation;

function startRound(){
phase="betting";
multiplier=1;
document.getElementById("multiplierDisplay").innerText="1.00x";
crashPoint=(1/(1-Math.random()))*0.97;
setTimeout(startFlight,5000);
}

function startFlight(){
phase="flying";
animate();
}

function animate(){
multiplier+=0.01; // SABİT %1 hız
document.getElementById("multiplierDisplay").innerText=
multiplier.toFixed(2)+"x";

if(multiplier>=crashPoint){
cancelAnimationFrame(animation);
addHistory(multiplier);
phase="crashed";
setTimeout(startRound,3000);
return;
}

animation=requestAnimationFrame(animate);
}

function addHistory(val){
let item=document.createElement("div");
item.className="historyItem";
item.innerText=val.toFixed(2)+"x";
document.getElementById("historyList").prepend(item);
}

/* BET */
let bet1=1,bet2=1;

function updateUI(){
document.getElementById("betDisplay1").innerText=bet1.toFixed(2);
document.getElementById("betDisplay2").innerText=bet2.toFixed(2);
}
updateUI();

document.getElementById("minus1").onclick=()=>{bet1=Math.max(0.1,bet1-0.1);updateUI();}
document.getElementById("plus1").onclick=()=>{bet1+=0.1;updateUI();}
document.getElementById("minus2").onclick=()=>{bet2=Math.max(0.1,bet2-0.1);updateUI();}
document.getElementById("plus2").onclick=()=>{bet2+=0.1;updateUI();}

document.querySelectorAll(".quick1").forEach(btn=>{
btn.onclick=()=>{bet1=parseFloat(btn.dataset.bet);updateUI();}
});
document.querySelectorAll(".quick2").forEach(btn=>{
btn.onclick=()=>{bet2=parseFloat(btn.dataset.bet);updateUI();}
});

document.getElementById("betBtn1").onclick=()=>handleBet(1);
document.getElementById("betBtn2").onclick=()=>handleBet(2);

function handleBet(i){
let amt=i===1?bet1:bet2;

if(phase==="betting"){
if(balance<amt) return;
balance-=amt;
updateBalance(balance);
}
else if(phase==="flying"){
balance+=amt*multiplier;
updateBalance(balance);
}
}

startRound();
</script>

</body>
</html>
