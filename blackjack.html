<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PixselArena Blackjack Live</title>
<style>
body{margin:0;overflow:hidden;background:#000;font-family:Arial;color:white;}
#ui{position:absolute;top:0;width:100%;pointer-events:none;}

.top-bar{
height:85px;
background:linear-gradient(to bottom,#1b2735,#0f141c);
display:flex;
justify-content:space-between;
align-items:center;
padding:0 20px;
pointer-events:auto;
}

.balance{
background:linear-gradient(45deg,#ff6a00,#ff2e00);
padding:10px 20px;
border-radius:15px;
font-weight:bold;
}

.stage-frame{
position:absolute;
top:110px;
left:50%;
transform:translateX(-50%);
width:85%;
height:200px;
border-radius:30px;
border:8px solid #ff6a00;
box-shadow:0 0 40px #ff6a00;
display:flex;
justify-content:center;
align-items:center;
font-size:28px;
text-shadow:0 0 25px orange;
}

.controls{
position:absolute;
bottom:40px;
width:100%;
display:flex;
justify-content:center;
gap:20px;
pointer-events:auto;
}

button{
padding:12px 20px;
border:none;
border-radius:10px;
font-size:16px;
cursor:pointer;
}

.hit{background:#2e7d32;color:white;}
.stand{background:#c62828;color:white;}
.deal{background:#f9a825;color:black;}

.info{
position:absolute;
bottom:120px;
width:100%;
text-align:center;
font-weight:bold;
}
</style>
</head>
<body>

<div id="ui">
<div class="top-bar">
<div class="balance">Bakiye ₺<span id="balance">1000</span></div>
<div>☰</div>
</div>

<div class="stage-frame">
PixselArena<br>Blackjack Live
</div>

<div class="info" id="infoText">Bahis Yapın</div>

<div class="controls">
<button class="deal" onclick="startGame()">DEAL</button>
<button class="hit" onclick="hit()">HIT</button>
<button class="stand" onclick="stand()">STAND</button>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

<script>
let balance=1000;
let bet=100;
let player=[],dealer=[],deck=[];
let gameActive=false;

const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,1000);
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

camera.position.set(0,7,13);
camera.lookAt(0,0,0);

/* Evolution Style Lighting */
scene.add(new THREE.AmbientLight(0xffffff,0.6));

const orangeLight=new THREE.PointLight(0xff6600,3,50);
orangeLight.position.set(0,10,5);
scene.add(orangeLight);

const spot=new THREE.SpotLight(0xff8800,4);
spot.position.set(0,15,5);
spot.angle=0.4;
scene.add(spot);

/* TABLE */
const table=new THREE.Mesh(
new THREE.CylinderGeometry(9,9,1,64),
new THREE.MeshStandardMaterial({color:0x0b0b0b})
);
table.position.y=-2;
scene.add(table);

const edge=new THREE.Mesh(
new THREE.TorusGeometry(9,0.3,16,100),
new THREE.MeshBasicMaterial({color:0xff6600})
);
edge.rotation.x=Math.PI/2;
edge.position.y=-1.5;
scene.add(edge);

/* CARD */
function createCard(){
return new THREE.Mesh(
new THREE.BoxGeometry(1.6,0.05,2.4),
new THREE.MeshStandardMaterial({color:0xffffff})
);
}

/* DECK */
function initDeck(){
deck=[];
const suits=["S","H","D","C"];
const vals=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];
for(let d=0;d<8;d++)
for(let s of suits)
for(let v of vals)
deck.push({v,s});
deck.sort(()=>Math.random()-0.5);
}

function draw(){return deck.pop();}

function value(hand){
let t=0,a=0;
hand.forEach(c=>{
if(["J","Q","K"].includes(c.v))t+=10;
else if(c.v==="A"){t+=11;a++;}
else t+=parseInt(c.v);
});
while(t>21&&a>0){t-=10;a--;}
return t;
}

function animateDeal(card,x,z){
card.position.set(0,5,-6);
scene.add(card);
let target=new THREE.Vector3(x,-1,z);
let t=0;
function anim(){
t+=0.02;
card.position.lerpVectors(
new THREE.Vector3(0,5,-6),
target,t
);
if(t<1)requestAnimationFrame(anim);
}
anim();
}

function flip(card){
let t=0;
function anim(){
t+=0.05;
card.rotation.y=Math.PI*t;
if(t<1)requestAnimationFrame(anim);
}
anim();
}

function startGame(){
if(gameActive) return;
if(balance<bet){alert("Bakiye Yetersiz");return;}

balance-=bet;
updateBalance();
initDeck();
player=[];dealer=[];
gameActive=true;

dealTo(player,-2);
dealTo(dealer,2);
dealTo(player,-0.5);
dealTo(dealer,0.5);

document.getElementById("infoText").innerText="Oyun Başladı";
}

function dealTo(hand,x){
let data=draw();
hand.push(data);
let card=createCard();
animateDeal(card,x+(hand.length*1.8),0);
setTimeout(()=>flip(card),800);
}

function hit(){
if(!gameActive) return;
dealTo(player,-2);
if(value(player)>21) endGame();
}

function stand(){
if(!gameActive) return;
while(value(dealer)<17){
dealTo(dealer,2);
}
endGame();
}

function endGame(){
gameActive=false;
let p=value(player);
let d=value(dealer);
let result="";

if(p>21) result="Kaybettiniz";
else if(d>21||p>d){balance+=bet*2;result="Kazandınız";}
else if(p===d){balance+=bet;result="Berabere";}
else result="Kaybettiniz";

updateBalance();
document.getElementById("infoText").innerText=result;
}

function updateBalance(){
document.getElementById("balance").innerText=balance;
}

function animate(){
requestAnimationFrame(animate);
renderer.render(scene,camera);
}
animate();

addEventListener("resize",()=>{
camera.aspect=innerWidth/innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(innerWidth,innerHeight);
});
</script>

</body>
</html>
